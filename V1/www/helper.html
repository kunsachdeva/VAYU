<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=no">
    <style>
        @-ms-viewport {
            width: 100vw;
            min-zoom: 100%;
            zoom: 100%;
        }

        @viewport {
            width: 100vw;
            min-zoom: 100% zoom: 100%;
        }

        @-ms-viewport {
            user-zoom: fixed;
            min-zoom: 100%;
        }

        @viewport {
            user-zoom: fixed;
            min-zoom: 100%;
        }
    </style>
    <!-- <script src="cordova.js"></script> -->          <!-- phantom library, needed for Cordova api calls, added during build -->
    <script src="js/app.js"></script>
    <script src="xdk/init-dev.js"></script>

    <title></title>
    <link href="css/font.css" rel="stylesheet">
    <link href="css/materialize.min.css" rel="stylesheet" />
    <script src="js/jq.js"></script>
    <script src="js/materialize.min.js"></script>
    <script>
        $(document).ready(function () {
            $(".button-collapse").sideNav();
            var user;
            //   $("#loginPage").hide(0);
            $("#loginBtn").click(function () {
                $("#loader").css("display", "block");
                $("#loginForm").css("display", "none");
                var e = $.trim($("#email").val());
                var p = $.trim($("#pass").val());
                $.ajax({
                    url: "http://vayu-api.herokuapp.com/user",
                    method: "GET",
                    contentType: "application/json",
                    headers: { "Authorization": "Basic " + btoa(e + ":" + p) }
                }).done(function (data1) {
                    user = data1; $("#loginPage").hide(0);
                    $("#logo").css("width", "300px");
                    $("#mainPage").css("display", "block");
                    // $("#mainPage").text(JSON.stringify(user));
                    $.ajax({
                        url: "http://vayu-api.herokuapp.com/api/file/" + user.home,
                        method: "GET",
                        contentType: "application/json",
                        headers: { "Authorization": "Basic " + btoa(user._id + ":" + user.apiKey) }
                    }).done(function (data2) {
                        if (data2.files.length > 0) {
                            $.each(data2.files, function (index, value) {
                                {
                                    $("#filesCollection").html($("#filesCollection").html() +
                                        "<li class='collection-item avatar'><i class='material-icons circle'>folder</i><span class='title'>" + this.name + this.extension + "</span><p>" + this.type + "   " + this.size + "B" + "</p><a href='#!' class='secondary-content'><i class='material-icons'>grade</i></a></li>"
                                        );
                                }
                            });
                        }
                        if (data2.folders.length > 0) {
                            $.each(data2.folders, function (index, value) {
                                {
                                    $("#foldersCollection").html($("#foldersCollection").html() +
                                        "<li class='collection-item avatar'><i class='material-icons circle'>folder</i><span class='title'>" +this.name + this.extension + "</span><p>" + this.type + "   " + this.size + "B" + "</p><a href='#!' class='secondary-content'><i class='material-icons'>grade</i></a></li>"
                                        );
                                }
                            });

                        }
                        else $("#foldersCollection").hide(0);
                    }).fail(function () { alert("1232") });
                }).fail(function () {
                    $("#loader").css("display", "none");
                    $("#loginForm").css("display", "block");
                    Materialize.toast('Login failed!', 4000);
                });
            });
            $("#newUserBtn").click(function () {
                $("#loginPage").hide(0);
                $("#signupPage").css("display", "block");
            });
            $("#signupBtn").click(function () {
                $("#loader2").css("display", "block");
                $("#loginForm2").css("display", "none");
                var e = $.trim($("#email_").val());
                var p = $.trim($("#pass_").val());
                var l = $.trim($("#lname_").val());
                var f = $.trim($("#fname_").val());
                $.post("http://vayu-api.herokuapp.com/user", { name: { first: f, last: l }, email: e, password: p })
            .done(function (data1) {
                user = data1; $("#signUp").hide(0);
                $("#logo").css("width", "300px");
                $("#mainPage").css("display", "block");
            }).fail(function () {
                $("#loader2").css("display", "none");
                $("#loginForm2").css("display", "block");
                Materialize.toast('Sign Up failed!', 4000);
            });
            });
        });
    </script>
</head>
<body style="background-color:rgb(250,250,250)">
    <div id="loginPage">
        <div style="text-align:center;margin-top:60px;margin-bottom:50px;"> <img src="img/logo1.png" id="logo" style="width:90%;max-width:400px" /></div>
        <div class="row">
            <form class="col s12">
                <div class="row">
                    <div id="loader" style="text-align:center;margin-top:81px;display:none">
                        <div class="preloader-wrapper big active">
                            <div class="spinner-layer spinner-blue">
                                <div class="circle-clipper left">
                                    <div class="circle"></div>
                                </div><div class="gap-patch">
                                    <div class="circle"></div>
                                </div><div class="circle-clipper right">
                                    <div class="circle"></div>
                                </div>
                            </div>
                            <div class="spinner-layer spinner-red">
                                <div class="circle-clipper left">
                                    <div class="circle"></div>
                                </div><div class="gap-patch">
                                    <div class="circle"></div>
                                </div><div class="circle-clipper right">
                                    <div class="circle"></div>
                                </div>
                            </div>

                            <div class="spinner-layer spinner-yellow">
                                <div class="circle-clipper left">
                                    <div class="circle"></div>
                                </div><div class="gap-patch">
                                    <div class="circle"></div>
                                </div><div class="circle-clipper right">
                                    <div class="circle"></div>
                                </div>
                            </div>

                            <div class="spinner-layer spinner-green">
                                <div class="circle-clipper left">
                                    <div class="circle"></div>
                                </div><div class="gap-patch">
                                    <div class="circle"></div>
                                </div><div class="circle-clipper right">
                                    <div class="circle"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="loginForm">
                        <div class="input-field col s12">
                            <i class="material-icons prefix">account_circle</i>
                            <input id="email" type="text">
                            <label for="icon_prefix">Email</label>
                        </div>
                        <div class="input-field col s12">
                            <i class="material-icons prefix">lock</i>
                            <input id="pass" type="tel">
                            <label for="icon_telephone">Password</label>
                        </div>
                    </div>
                    <div class="input-field col s12 centered" style="text-align:center">
                        <a id="loginBtn" class="waves-effect waves-light btn">Log In</a>
                    </div>
                </div>
            </form>
        </div>
        <div class="input-field col s12 centered" style="text-align:center;position:fixed;bottom:0;width:80%;margin-left:10%;margin-right:10%">
            <a id="newUserBtn" class="waves-effect waves-red btn-flat">New User? Join in here!</a>
        </div>
    </div>
    <div id="mainPage" style="display:none">
        <nav style="height:50px">
            <div class="nav-wrapper" style="background:orange;">
                <a href="#!" class="brand-logo" style="position:fixed;left:103px"><img src="img/logo1.png" id="logo" style="height:30px;margin-top:10px" /></a>
                <a href="#" data-activates="mobile-demo" class="button-collapse" style="position:fixed;left:-13px"><i class="material-icons">menu</i></a>
                <ul class="right">
                    <li><a href="sass.html"><i class="material-icons">search</i></a></li>
                    <li><a href="badges.html"><i class="material-icons">view_module</i></a></li>
                    <li><a href="collapsible.html"><i class="material-icons">refresh</i></a></li>
                    <li><a href="mobile.html"><i class="material-icons">more_vert</i></a></li>
                </ul>
                <ul class="side-nav" id="mobile-demo">
                    <li><a href="sass.html">Sass</a></li>
                    <li><a href="badges.html">Components</a></li>
                    <li><a href="collapsible.html">Javascript</a></li>
                    <li><a href="mobile.html">Mobile</a></li>
                </ul>
            </div>
        </nav>
        <div class="row">
            <div class="col s12">
                <ul class="collection" id="foldersCollection">
                </ul>
                <ul class="collection" id="filesCollection"></ul>
            </div>
        </div>
    </div>
    <style>
        nav .nav-wrapper i {
            line-height: 50px !important;
        }

        h5 {
            color: grey;
        }
    </style>
</body>
</html>
